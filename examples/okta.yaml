# Okta SAML Configuration Example

server:
  host: "0.0.0.0"
  port: 8080
  base_url: "https://sso.example.com"
  cookie_domain: ".example.com"
  cookie_secure: true
  session_ttl: "24h"

backend:
  url: "http://backend-service:8000"
  timeout: "30s"

cache:
  type: "memory"

providers:
  - id: "okta"
    name: "Okta SSO"
    type: "saml"
    saml:
      # Get metadata URL from Okta > Applications > Your App > Sign On > Metadata URL
      idp_metadata_url: "https://dev-xxx.okta.com/app/xxx/sso/saml/metadata"

      # Or provide metadata inline:
      # idp_metadata_xml: |
      #   <?xml version="1.0" encoding="UTF-8"?>
      #   <EntityDescriptor ...>

      # Service Provider settings
      sp_entity_id: "https://sso.example.com/saml/metadata"
      acs_url: "https://sso.example.com/auth/saml/okta/acs"

      # Generate certificate and key:
      # openssl req -x509 -newkey rsa:2048 -keyout sp-key.pem -out sp-cert.pem -days 365 -nodes
      certificate_path: "/etc/sso-switch/certs/sp-cert.pem"
      private_key_path: "/etc/sso-switch/certs/sp-key.pem"

    header_mappings:
      # Standard SAML attribute names
      "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress": "X-User-Email"
      "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name": "X-User-Name"
      "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn": "X-User-Username"

      # Okta-specific attributes (configure in Okta)
      "firstName": "X-User-FirstName"
      "lastName": "X-User-LastName"
      "groups": "X-User-Groups"

logging:
  level: "info"
  format: "json"

# Configure in Okta:
# 1. Create a SAML 2.0 application
# 2. Set Single sign on URL: https://sso.example.com/auth/saml/okta/acs
# 3. Set Audience URI: https://sso.example.com/saml/metadata
# 4. Configure attribute statements in Okta to match header_mappings
